<!DOCTYPE html>
<html
  lang="es"
  x-data="{ darkMode: localStorage.getItem('darkMode') === 'true', showSearch: false }"
  :class="{ 'dark': darkMode }"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Smart Stack{% endblock %}</title>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <link
      rel="shortcut icon"
      href="{{ url_for('static', filename='favicon.ico') }}"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          fontFamily: {
            sans: ["Inter", "sans-serif"],
          },
          extend: {
            colors: {
              primary: "#1e3a8a",
              accent: "#f59e0b",
            },
          },
        },
      };
    </script>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
  </head>

  <body
    class="bg-gray-50 dark:bg-slate-900 text-gray-800 dark:text-white font-sans transition-colors duration-300"
  >
    <div class="flex flex-col min-h-screen">
      {% if show_main_navbar is not defined or show_main_navbar %}
      <!-- Navbar  -->
      <nav
        class="sticky top-0 z-50 bg-primary text-white px-4 py-3 shadow-md flex flex-wrap items-center justify-between gap-4 border-b border-blue-900"
      >
        <!-- Logo -->
        <div class="flex items-center gap-4">
          <a href="{{ url_for('books.dashboard') }}">
            <img
            src="{{ url_for('static', filename='images/logo.png') }}"
            alt="Smart Stack Logo"
            class="h-20 md:h-24 w-auto"
          />
          </a>
          
        </div>

        <!-- Searchbox desktop -->
        <form
          method="GET"
          action="{{ url_for('books.search_books') }}"
          class="hidden md:block max-w-lg w-full relative"
        >
          <input
            type="text"
            name="q"
            placeholder="Buscar tÃ­tulo, autor o ISBN..."
            class="w-full pl-4 pr-16 py-2 rounded-full bg-white text-gray-800 dark:bg-slate-700 dark:text-white shadow focus:outline-none focus:ring-2 focus:ring-accent text-sm"
          />
          <button
            type="submit"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-300"
          >
            <i class="fas fa-search"></i>
          </button>
          <a
            href="{{ url_for('books.isbn_scan') }}"
            class="absolute right-10 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-300"
            title="Escanear ISBN"
          >
            <i class="fas fa-barcode"></i>
          </a>
        </form>

        <div class="flex flex-col items-center gap-4 w-full md:w-auto">
          <div class="flex justify-around w-full md:gap-6">
            {% set nav_items = [ {'url': 'books.dashboard', 'icon': 'fa-home',
            'label': 'Inicio'}, {'url': 'books.isbn_scan', 'icon': 'fa-barcode',
            'label': 'Escanear'}, {'url': 'books.view_library', 'icon':
            'fa-book', 'label': 'Biblioteca'}, {'url': 'books.view_wishlist',
            'icon': 'fa-heart', 'label': 'Wishlist'}, {'url':
            'books.recommendations', 'icon': 'fa-star', 'label':
            'Recomendaciones'}, {'url': 'auth.logout', 'icon':
            'fa-sign-out-alt', 'label': 'Salir'} ] %}

            <button
              @click="showSearch = !showSearch"
              class="md:hidden flex flex-col items-center text-xs hover:text-accent transition"
            >
              <i class="fas fa-search text-lg"></i>
              <span>Buscar</span>
            </button>

            {% for item in nav_items %}
            <a
              href="{{ url_for(item.url) }}"
              class="flex flex-col items-center text-xs hover:text-accent transition"
            >
              <i class="fas {{ item.icon }} text-lg"></i>
              <span class="hidden md:inline">{{ item.label }}</span>
            </a>
            {% endfor %}
          </div>
        </div>
      </nav>
      {% endif %}

      <div class="fixed top-[180px] right-0 z-50">
        {% if hide_theme_toggle_mobile %}
        <div class="hidden md:block">
          <button
            @click="darkMode = !darkMode; localStorage.setItem('darkMode', darkMode)"
            class="bg-white dark:bg-slate-700 text-lg p-3 rounded-full shadow hover:bg-gray-100 dark:hover:bg-slate-600 transition"
            title="Cambiar tema"
          >
            <span x-text="darkMode ? 'ðŸŒ™' : 'â˜€ï¸'"></span>
          </button>
        </div>
        {% else %}
        <button
          @click="darkMode = !darkMode; localStorage.setItem('darkMode', darkMode)"
          class="bg-white dark:bg-slate-700 text-lg p-3 rounded-full shadow hover:bg-gray-100 dark:hover:bg-slate-600 transition"
          title="Cambiar tema"
        >
          <span x-text="darkMode ? 'ðŸŒ™' : 'â˜€ï¸'"></span>
        </button>
        {% endif %}
      </div>

      <!-- Searchbox mobile -->
      <div x-show="showSearch" x-transition class="md:hidden px-4 py-2">
        <form
          method="GET"
          action="{{ url_for('books.search_books') }}"
          class="bg-white dark:bg-slate-800 rounded-full shadow p-2"
        >
          <input
            type="text"
            name="q"
            placeholder="Buscar tÃ­tulo, autor o ISBN..."
            class="w-full px-4 py-2 rounded-full bg-gray-100 dark:bg-slate-700 text-sm text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-accent"
          />
        </form>
      </div>

      <!-- Page Content -->
      <main class="flex-grow p-6">{% block content %}{% endblock %}</main>

      <!-- Footer -->
      <footer
        class="bg-primary text-white text-center text-xs py-4 shadow-inner"
      >
        Smart Stack â€” Organiza. Descubre. Crece. Â© 2025
      </footer>
    </div>
  </body>
</html>
