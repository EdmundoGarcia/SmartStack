{% extends "layouts/base_user.html" %} {% block title %}Mi Wishlist -
SmartStack{% endblock %} {% block user_content %}
<h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-white">
  Libros en tu wishlist
</h2>

{% if books %}
<div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6">
  {% for book in books %}
  <div
    class="relative bg-white dark:bg-slate-800 rounded-lg shadow-md overflow-hidden flex flex-col"
  >
    <form
      action="{{ url_for('books.remove_from_wishlist') }}"
      method="POST"
      class="absolute top-2 right-2 z-10"
    >
      <input type="hidden" name="book_id" value="{{ book.google_id }}" />
      <button
        type="submit"
        title="Eliminar de wishlist"
        class="text-red-600 hover:text-red-800"
      >
        <i class="fas fa-circle-xmark fa-lg"></i>
      </button>
    </form>

    <a
      href="{{ url_for('books.book_detail', id=book.google_id) }}"
      class="w-full h-64 bg-gray-100 dark:bg-slate-700 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-slate-600 transition"
    >
      {% if book.small_thumbnail %}
      <img
        src="{{ book.small_thumbnail }}"
        alt="Portada"
        class="max-h-full max-w-full object-contain"
      />
      {% else %}
      <span class="text-gray-400 dark:text-gray-500 text-sm">Sin portada</span>
      {% endif %}
    </a>

    <div class="p-4 flex flex-col justify-between flex-grow">
      <a
        href="{{ url_for('books.book_detail', id=book.google_id) }}"
        class="hover:underline"
      >
        <h3
          class="font-semibold text-base mb-1 line-clamp-2 text-gray-800 dark:text-white"
        >
          {{ book.title }}
        </h3>
      </a>
      <p class="text-xs text-gray-600 dark:text-gray-300 mb-1">
        {{ book.author }}
      </p>
      <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">
        Idioma: {{ book.language or 'N/A' }}
      </p>

      <!-- Move to library -->
      <form action="{{ url_for('books.add_to_library') }}" method="POST">
        <input type="hidden" name="book_id" value="{{ book.google_id }}" />
        <input type="hidden" name="title" value="{{ book.title }}" />
        <input type="hidden" name="authors" value="{{ book.author }}" />
        <input type="hidden" name="language" value="{{ book.language }}" />
        <input
          type="hidden"
          name="thumbnail"
          value="{{ book.small_thumbnail }}"
        />
        <input type="hidden" name="isbn" value="{{ book.isbn }}" />
        <input type="hidden" name="categories" value="{{ book.categories }}" />
        <input
          type="hidden"
          name="submitted"
          value="{{ range(1000000)|random }}"
        />
        <button
          type="submit"
          class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm flex items-center gap-1"
        >
          <i class="fas fa-bookmark"></i> Mover a biblioteca
        </button>
      </form>
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
<p class="text-gray-600 dark:text-gray-300">
  Tu wishlist está vacía por ahora.
</p>
{% endif %} {% endblock %}
